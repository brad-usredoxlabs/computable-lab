$schema: "https://json-schema.org/draft/2020-12/schema"
$id: "https://computable-lab.com/schema/computable-lab/datatypes/plate-event.schema.yaml"
title: "PlateEvent"
type: object
description: >
  Canonical semantic event that affects plate state or observes plate state. Plate state/layout is derived by replaying the time-ordered sequence of PlateEvents.

additionalProperties: false

required:
- eventId
- event_type
- details

properties:
  eventId:
    type: string
    description: "Stable event identifier (unique within the run/timeline)."

  event_type:
    type: string
    description: "Event verb."
    enum:
    - add_material
    - transfer
    - mix
    - wash
    - incubate
    - read
    - harvest
    - other

  at:
    type: string
    format: date-time
    description: "Actual execution timestamp, if known."

  t_offset:
    type: string
    description: "Optional planned time offset from run start (ISO-8601 duration, e.g. 'PT5M')."

  notes:
    type: string

  details:
    description: "Event-type-specific payload."
    oneOf:
    - $ref: "./plate-event.add-material.schema.yaml"
    - $ref: "./plate-event.transfer.schema.yaml"
    - $ref: "./plate-event.mix.schema.yaml"
    - $ref: "./plate-event.wash.schema.yaml"
    - $ref: "./plate-event.incubate.schema.yaml"
    - $ref: "./plate-event.read.schema.yaml"
    - $ref: "./plate-event.harvest.schema.yaml"
    - $ref: "./plate-event.other.schema.yaml"

anyOf:
- required: [ "at" ]
- required: [ "t_offset" ]
